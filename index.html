<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì‹¤í—˜ìš© - ì™„ì „ ê´€ë¦¬ ë²„ì „</title>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 20px;
  background: #fff;
  color: #000;
  transition: background 0.3s, color 0.3s;
}
body.dark { background: #121212; color: #fff; }
h1 { color: #2c3e50; }
body.dark h1 { color: #f1c40f; }

/* ===== ìƒë‹¨ ì»¨íŠ¸ë¡¤ ===== */
.top-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 10px;
}

/* ===== í•„í„° ì˜ì—­ ===== */
.filters {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 20px;
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
  align-items: center;
  max-width: 1100px;
  margin-left: auto;
  margin-right: auto;
  box-sizing: border-box;
}
body.dark .filters { background: #2d2d2d; }
.filter-group { display: flex; flex-direction: column; gap: 5px; }
.filter-group label { font-weight: bold; font-size: 14px; }
select, .filter-buttons {
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 4px;
  background: white;
}
body.dark select { background: #333; color: #fff; border-color: #555; }
.filter-buttons { display: flex; gap: 5px; flex-wrap: wrap; }
.filter-btn {
  padding: 5px 12px;
  border: 1px solid #ddd;
  background: white;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  white-space: nowrap;
}
.filter-btn.active { background: #007bff; color: white; border-color: #007bff; }
body.dark .filter-btn { background: #444; color: #fff; border-color: #666; }
body.dark .filter-btn.active { background: #0056b3; border-color: #0056b3; }

/* ===== ì¹´í…Œê³ ë¦¬/ì¹´ë“œ ===== */
.categories-container {
  max-width: 1100px;
  margin: 20px auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 20px;
  box-sizing: border-box;
}
.category-section { margin: 0; border: 1px solid #e0e0e0; border-radius: 10px; overflow: hidden; }
body.dark .category-section { border-color: #444; }
.category-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 15px 20px;
  font-size: 20px;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 10px;
}
.category-content { padding: 20px; background: #fafafa; }
body.dark .category-content { background: #1a1a1a; }

.link-card {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  margin: 10px 0;
  background: white;
  position: relative;
  transition: all 0.2s;
}
.link-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
body.dark .link-card { background: #2d2d2d; border-color: #555; }
body.dark .link-card:hover { box-shadow: 0 4px 12px rgba(255,255,255,0.1); }
.link-card a { text-decoration: none; color: #2980b9; font-weight: bold; font-size: 18px; }
body.dark .link-card a { color: #4aa3ff; }

.link-meta { display: flex; gap: 10px; margin: 8px 0; font-size: 12px; color: #666; flex-wrap: wrap; }
body.dark .link-meta { color: #aaa; }
.tag { background: #e9ecef; padding: 3px 8px; border-radius: 12px; font-size: 11px; white-space: nowrap; }
body.dark .tag { background: #495057; color: #fff; }
.age-tag { background: #d4edda; color: #155724; }
.category-tag { background: #fff3cd; color: #856404; }
body.dark .age-tag { background: #28a745; color: white; }
body.dark .category-tag { background: #ffc107; color: #212529; }

.card-buttons { position: absolute; top: 8px; right: 8px; display: flex; gap: 5px; }
.card-btn {
  border: none; border-radius: 50%; width: 25px; height: 25px;
  cursor: pointer; font-size: 14px; color: white;
  display: flex; align-items: center; justify-content: center;
}
.edit-btn { background: #3498db; }
.delete-btn { background: #e74c3c; }

/* ===== ë²„íŠ¼/í¼ ===== */
button { padding: 8px 16px; margin: 5px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
.dark-toggle { background: #333; color: #fff; }
.add-btn { background: #27ae60; color: white; font-size: 16px; }

/* ===== íŒì—…/ê²°ê³¼/í†µê³„ ===== */
#popup-container { position: fixed; top: 20px; right: 20px; z-index: 1000; display: flex; flex-direction: column; gap: 10px; }
.popup {
  padding: 15px 20px; border-radius: 8px; color: white; font-weight: bold;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  opacity: 0.95; transform: translateX(120%);
  transition: transform 0.4s ease-in-out;
}
.popup.show { transform: translateX(0); }
.popup.success { background: #2ecc71; }
.popup.error { background: #e74c3c; }

.no-results {
  text-align: center; color: #666; font-style: italic;
  padding: 40px; background: #f8f9fa; border-radius: 8px; margin: 20px 0;
}
body.dark .no-results { color: #aaa; background: #2d2d2d; }

.stats {
  display: flex; justify-content: space-between; margin: 10px 0;
  font-size: 12px; color: #666;
  max-width: 1100px; margin-left: auto; margin-right: auto;
  box-sizing: border-box;
}
body.dark .stats { color: #aaa; }

/* ===== ëª¨ë‹¬ ===== */
.modal-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.6); display: none;
  justify-content: center; align-items: center; z-index: 999;
}
.modal-content {
  background: white; padding: 30px; border-radius: 12px;
  width: 90%; max-width: 500px; max-height: 80vh; overflow-y: auto;
  position: relative;
}
body.dark .modal-content { background: #2d2d2d; }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.modal-header h3 { margin: 0; color: #2c3e50; }
body.dark .modal-header h3 { color: #f1c40f; }
.close-btn { background: #e74c3c; color: white; border-radius: 50%; width: 30px; height: 30px; border: none; cursor: pointer; }
.form-group { margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
.form-group input, .form-group textarea, .form-group select {
  width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;
  box-sizing: border-box; font-family: inherit;
}
body.dark .form-group input, body.dark .form-group textarea, body.dark .form-group select {
  background: #333; color: #fff; border-color: #555;
}
.checkbox-group { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 5px; }
.checkbox-item { display: flex; align-items: center; gap: 5px; }
.checkbox-item input { width: auto; margin: 0; }
.save-btn { background: #27ae60; color: white; padding: 12px 24px; }
.cancel-btn { background: #6c757d; color: white; padding: 12px 24px; }

/* ===== ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ ===== */
.data-management {
  max-width: 1100px; margin: 20px auto; padding: 20px;
  background: #f8f9fa; border-radius: 8px;
}
body.dark .data-management { background: #2d2d2d; }
.data-controls { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px; }
.export-btn { background: #17a2b8; color: white; }
.import-btn { background: #fd7e14; color: white; }
.reset-btn { background: #dc3545; color: white; }
#importFile { display: none; }
</style>
</head>
<body>
<div class="top-controls">
  <h1>ğŸ“š ì‹¤í—˜ì¤‘ì¸ ì‚¬ì´íŠ¸ - ì™„ì „ ê´€ë¦¬ ë²„ì „</h1>
  <div>
    <button class="add-btn" onclick="openAddModal()">â• ìƒˆ ì‚¬ì´íŠ¸ ì¶”ê°€</button>
    <button class="dark-toggle" onclick="toggleDarkMode()">ğŸŒ™ ë‹¤í¬ ëª¨ë“œ ì „í™˜</button>
  </div>
</div>

<div id="popup-container"></div>

<div class="filters">
  <div class="filter-group"><label>ì—°ë ¹ëŒ€:</label><div class="filter-buttons" id="ageFilter">
    <button class="filter-btn active" data-age="all">ì „ì²´</button>
    <button class="filter-btn" data-age="elem">ì´ˆë“±</button>
    <button class="filter-btn" data-age="mid">ì¤‘ë“±</button>
    <button class="filter-btn" data-age="high">ê³ ë“±</button>
    <button class="filter-btn" data-age="adult">ì„±ì¸</button>
  </div></div>
  <div class="filter-group"><label>ì¹´í…Œê³ ë¦¬:</label><div class="filter-buttons" id="categoryFilter">
    <button class="filter-btn active" data-category="all">ì „ì²´</button>
    <button class="filter-btn" data-category="learning">í•™ìŠµ</button>
    <button class="filter-btn" data-category="info">ì •ë³´</button>
    <button class="filter-btn" data-category="news">ë‰´ìŠ¤</button>
    <button class="filter-btn" data-category="search">ê²€ìƒ‰ì—”ì§„</button>
  </div></div>
  <div class="filter-group"><label>ê³¼ëª©:</label>
    <select id="subjectFilter">
      <option value="all">ì „ì²´ ê³¼ëª©</option>
      <option value="korean">êµ­ì–´</option>
      <option value="math">ìˆ˜í•™</option>
      <option value="english">ì˜ì–´</option>
      <option value="science">ê³¼í•™</option>
      <option value="social">ì‚¬íšŒ</option>
      <option value="history">ì—­ì‚¬</option>
      <option value="art">ì˜ˆìˆ </option>
      <option value="music">ìŒì•…</option>
      <option value="pe">ì²´ìœ¡</option>
      <option value="tech">ê¸°ìˆ </option>
      <option value="coding">ì½”ë”©</option>
      <option value="language">ì™¸êµ­ì–´</option>
      <option value="general">ì¢…í•©</option>
      <option value="exam">ì‹œí—˜ëŒ€ë¹„</option>
      <option value="career">ì§„ë¡œ</option>
    </select>
  </div>
  <div class="filter-group"><button onclick="resetFilters()" style="background:#6c757d;color:white;border:none;padding:8px 12px;border-radius:4px;">í•„í„° ì´ˆê¸°í™”</button></div>
</div>

<div class="stats">
  <span>ì´ <span id="totalCount">0</span>ê°œ ì‚¬ì´íŠ¸</span>
  <span>í•„í„°ë§ëœ ê²°ê³¼: <span id="filteredCount">0</span>ê°œ</span>
</div>

<div class="categories-container">
  <div class="category-section" id="learning-section">
    <div class="category-header">ğŸ“– í•™ìŠµ ì‚¬ì´íŠ¸</div>
    <div class="category-content" id="learning-content"></div>
  </div>
  <div class="category-section" id="info-section">
    <div class="category-header">ğŸ“‹ ì •ë³´ ì‚¬ì´íŠ¸</div>
    <div class="category-content" id="info-content"></div>
  </div>
  <div class="category-section" id="news-section">
    <div class="category-header">ğŸ“° ë‰´ìŠ¤ ì‚¬ì´íŠ¸</div>
    <div class="category-content" id="news-content"></div>
  </div>
  <div class="category-section" id="search-section">
    <div class="category-header">ğŸ” ê²€ìƒ‰ ì—”ì§„</div>
    <div class="category-content" id="search-content"></div>
  </div>
</div>

<div id="noResults" class="no-results" style="display:none;">ì¡°ê±´ì— ë§ëŠ” ì‚¬ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>

<!-- ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ -->
<div class="data-management">
  <h3>ğŸ“Š ë°ì´í„° ê´€ë¦¬</h3>
  <div class="data-controls">
    <button class="export-btn" onclick="exportData()">ğŸ“¥ ë°ì´í„° ë‚´ë³´ë‚´ê¸° (JSON)</button>
    <button class="import-btn" onclick="document.getElementById('importFile').click()">ğŸ“¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</button>
    <input type="file" id="importFile" accept=".json" onchange="importData(event)">
    <button class="reset-btn" onclick="resetAllData()">ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”</button>
  </div>
  <p style="font-size: 12px; color: #666; margin: 0;">
    * ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì €ì— ìë™ ì €ì¥ë©ë‹ˆë‹¤. ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°ë¡œ ë°±ì—… ë° ë³µì›ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
  </p>
</div>

<!-- ëª¨ë‹¬ -->
<div class="modal-overlay" id="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="modalTitle">ìƒˆ ì‚¬ì´íŠ¸ ì¶”ê°€</h3>
      <button class="close-btn" onclick="closeModal()">âœ•</button>
    </div>
    <form id="siteForm">
      <div class="form-group">
        <label for="siteName">ì‚¬ì´íŠ¸ ì´ë¦„ *</label>
        <input type="text" id="siteName" required>
      </div>
      <div class="form-group">
        <label for="siteUrl">URL *</label>
        <input type="url" id="siteUrl" required placeholder="https://example.com">
      </div>
      <div class="form-group">
        <label for="siteDesc">ì„¤ëª…</label>
        <textarea id="siteDesc" rows="3" placeholder="ì‚¬ì´íŠ¸ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…"></textarea>
      </div>
      <div class="form-group">
        <label for="siteCategory">ì¹´í…Œê³ ë¦¬ *</label>
        <select id="siteCategory" required>
          <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
          <option value="learning">í•™ìŠµ</option>
          <option value="info">ì •ë³´</option>
          <option value="news">ë‰´ìŠ¤</option>
          <option value="search">ê²€ìƒ‰ì—”ì§„</option>
        </select>
      </div>
      <div class="form-group">
        <label>ì—°ë ¹ëŒ€ * (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</label>
        <div class="checkbox-group" id="ageCheckboxes">
          <div class="checkbox-item"><input type="checkbox" id="age-elem" value="elem"><label for="age-elem">ì´ˆë“±í•™ìƒ</label></div>
          <div class="checkbox-item"><input type="checkbox" id="age-mid" value="mid"><label for="age-mid">ì¤‘í•™ìƒ</label></div>
          <div class="checkbox-item"><input type="checkbox" id="age-high" value="high"><label for="age-high">ê³ ë“±í•™ìƒ</label></div>
          <div class="checkbox-item"><input type="checkbox" id="age-adult" value="adult"><label for="age-adult">ì„±ì¸</label></div>
        </div>
      </div>
      <div class="form-group">
        <label>ê³¼ëª© (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</label>
        <div class="checkbox-group" id="subjectCheckboxes">
          <div class="checkbox-item"><input type="checkbox" id="subj-korean" value="korean"><label for="subj-korean">êµ­ì–´</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-math" value="math"><label for="subj-math">ìˆ˜í•™</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-english" value="english"><label for="subj-english">ì˜ì–´</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-science" value="science"><label for="subj-science">ê³¼í•™</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-social" value="social"><label for="subj-social">ì‚¬íšŒ</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-history" value="history"><label for="subj-history">ì—­ì‚¬</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-art" value="art"><label for="subj-art">ì˜ˆìˆ </label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-music" value="music"><label for="subj-music">ìŒì•…</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-pe" value="pe"><label for="subj-pe">ì²´ìœ¡</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-tech" value="tech"><label for="subj-tech">ê¸°ìˆ </label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-coding" value="coding"><label for="subj-coding">ì½”ë”©</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-language" value="language"><label for="subj-language">ì™¸êµ­ì–´</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-general" value="general"><label for="subj-general">ì¢…í•©</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-exam" value="exam"><label for="subj-exam">ì‹œí—˜ëŒ€ë¹„</label></div>
          <div class="checkbox-item"><input type="checkbox" id="subj-career" value="career"><label for="subj-career">ì§„ë¡œ</label></div>
        </div>
      </div>
      <div style="text-align: right; margin-top: 20px;">
        <button type="button" class="cancel-btn" onclick="closeModal()">ì·¨ì†Œ</button>
        <button type="submit" class="save-btn">ì €ì¥</button>
      </div>
    </form>
  </div>
</div>

<script>
const ageNames = {elem:"ì´ˆë“±í•™ìƒ",mid:"ì¤‘í•™ìƒ",high:"ê³ ë“±í•™ìƒ",adult:"ì„±ì¸"};
const categoryNames = {learning:"í•™ìŠµ",info:"ì •ë³´",news:"ë‰´ìŠ¤",search:"ê²€ìƒ‰ì—”ì§„"};
const subjectNames = {korean:"êµ­ì–´",math:"ìˆ˜í•™",english:"ì˜ì–´",science:"ê³¼í•™",social:"ì‚¬íšŒ",history:"ì—­ì‚¬",art:"ì˜ˆìˆ ",music:"ìŒì•…",pe:"ì²´ìœ¡",tech:"ê¸°ìˆ ",coding:"ì½”ë”©",language:"ì™¸êµ­ì–´",general:"ì¢…í•©",exam:"ì‹œí—˜ëŒ€ë¹„",career:"ì§„ë¡œ"};

let currentAgeFilter = "all";
let currentCategoryFilter = "all";
let currentSubjectFilter = "all";
let expandedCategories = {};
let editingIndex = -1;

// ì´ˆê¸° ë°ì´í„°
let sites = [
  {name:"EBS ì´ˆë“±",url:"https://www.ebs.co.kr/course/home?courseType=ELMT",desc:"ì´ˆë“± ì „ ê³¼ëª© ì˜¨ë¼ì¸ ê°•ì˜",category:"learning",ages:["elem"],subjects:["korean","math","science","social"]},
  {name:"Khan Academy",url:"https://ko.khanacademy.org/",desc:"ìˆ˜í•™, ê³¼í•™ ë¬´ë£Œ ê°•ì˜",category:"learning",ages:["elem","mid","high","adult"],subjects:["math","science"]},
  {name:"Code.org",url:"https://code.org",desc:"ì´ˆë“±~ê³ ë“± ì½”ë”© í•™ìŠµ",category:"learning",ages:["elem","mid","high"],subjects:["coding"]},
  {name:"Duolingo",url:"https://www.duolingo.com/",desc:"ì™¸êµ­ì–´ í•™ìŠµ ê²Œì„í˜• í”Œë«í¼",category:"learning",ages:["elem","mid","high","adult"],subjects:["language","english"]},
  {name:"ìœ„í‚¤ë°±ê³¼",url:"https://ko.wikipedia.org/",desc:"ììœ  ë°±ê³¼ì‚¬ì „",category:"info",ages:["mid","high","adult"],subjects:["general"]},
  {name:"êµ­ë¦½ì¤‘ì•™ê³¼í•™ê´€",url:"https://www.science.go.kr/",desc:"ê³¼í•™ ì²´í—˜ ë° êµìœ¡ ì •ë³´",category:"info",ages:["elem","mid","high"],subjects:["science"]},
  {name:"ì—°í•©ë‰´ìŠ¤",url:"https://www.yna.co.kr/",desc:"ëŒ€í•œë¯¼êµ­ ëŒ€í‘œ ë‰´ìŠ¤í†µì‹ ì‚¬",category:"news",ages:["mid","high","adult"],subjects:["social","general"]},
  {name:"BBC News",url:"https://www.bbc.com/korean",desc:"BBC í•œêµ­ì–´ ë‰´ìŠ¤",category:"news",ages:["high","adult"],subjects:["english","social"]},
  {name:"ë„¤ì´ë²„",url:"https://www.naver.com/",desc:"ëŒ€í•œë¯¼êµ­ ëŒ€í‘œ í¬í„¸ì‚¬ì´íŠ¸",category:"search",ages:["elem","mid","high","adult"],subjects:["general"]},
  {name:"êµ¬ê¸€",url:"https://www.google.com/",desc:"ì„¸ê³„ ìµœëŒ€ ê²€ìƒ‰ì—”ì§„",category:"search",ages:["elem","mid","high","adult"],subjects:["general"]}
];

// ë°ì´í„° ì €ì¥/ë¡œë“œ
function saveData() {
  try {
    const data = JSON.stringify(sites);
    window.savedSitesData = data; // ë©”ëª¨ë¦¬ì— ì €ì¥
    return true;
  } catch (error) {
    console.error('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
    return false;
  }
}

function loadData() {
  try {
    if (window.savedSitesData) {
      const data = JSON.parse(window.savedSitesData);
      if (Array.isArray(data)) {
        sites = data;
        return true;
      }
    }
    return false;
  } catch (error) {
    console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
    return false;
  }
}

// íŒì—… ì•Œë¦¼
function showPopup(message, isError = false) {
  const container = document.getElementById("popup-container");
  const popup = document.createElement("div");
  popup.className = `popup ${isError ? 'error' : 'success'}`;
  popup.textContent = message;
  container.appendChild(popup);
  setTimeout(() => popup.classList.add("show"), 10);
  setTimeout(() => {
    popup.classList.remove("show");
    popup.addEventListener('transitionend', () => popup.remove());
  }, 3000);
}

// í†µê³„ ì—…ë°ì´íŠ¸
function updateStats() {
  document.getElementById("totalCount").textContent = sites.length;
  document.getElementById("filteredCount").textContent = getFilteredSites().length;
}

// í•„í„°ë§ëœ ì‚¬ì´íŠ¸ ê°€ì ¸ì˜¤ê¸°
function getFilteredSites() {
  return sites.filter(s =>
    (currentAgeFilter === "all" || s.ages.includes(currentAgeFilter)) &&
    (currentCategoryFilter === "all" || s.category === currentCategoryFilter) &&
    (currentSubjectFilter === "all" || s.subjects.includes(currentSubjectFilter))
  );
}

// ì‚¬ì´íŠ¸ ì¹´ë“œ ìƒì„±
function createSiteCard(site, index) {
  const card = document.createElement("div");
  card.className = "link-card";
  
  const ageTags = site.ages.map(a => `<span class="tag age-tag">${ageNames[a]}</span>`).join(" ");
  const categoryTag = `<span class="tag category-tag">${categoryNames[site.category]}</span>`;
  
  card.innerHTML = `
    <div class="card-buttons">
      <button class="card-btn edit-btn" onclick="openEditModal(${index})" title="ìˆ˜ì •">âœï¸</button>
      <button class="card-btn delete-btn" onclick="deleteSite(${index})" title="ì‚­ì œ">ğŸ—‘ï¸</button>
    </div>
    <a href="${site.url}" target="_blank">${site.name}</a>
    <div class="link-meta">${categoryTag} ${ageTags}</div>
    <p>${site.desc || 'ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.'}</p>
  `;
  return card;
}

// ì‚¬ì´íŠ¸ ë Œë”ë§
function renderSites() {
  const categories = Object.keys(categoryNames);
  const allFilteredSites = getFilteredSites();
  let hasResults = allFilteredSites.length > 0;

  categories.forEach(category => {
    const container = document.getElementById(`${category}-content`);
    const section = document.getElementById(`${category}-section`);
    const sitesInCategory = allFilteredSites.filter(s => s.category === category);

    container.innerHTML = "";
    
    if (sitesInCategory.length > 0) {
      section.style.display = "block";
      sitesInCategory.forEach(site => {
        const idx = sites.indexOf(site);
        container.appendChild(createSiteCard(site, idx));
      });
    } else {
      section.style.display = (currentCategoryFilter === "all" || currentCategoryFilter === category) ? "block" : "none";
      container.innerHTML = "<p style='color:#666;text-align:center;padding:20px;'>í•´ë‹¹ ì¡°ê±´ì˜ ì‚¬ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
    }
  });

  document.getElementById("noResults").style.display = hasResults ? "none" : "block";
  updateStats();
}

// í•„í„° ì„¤ì •
function setupFilters() {
  document.querySelectorAll("#ageFilter .filter-btn").forEach(btn =>
    btn.addEventListener("click", e => {
      document.querySelector("#ageFilter .active").classList.remove("active");
      e.target.classList.add("active");
      currentAgeFilter = e.target.dataset.age;
      renderSites();
    })
  );

  document.querySelectorAll("#categoryFilter .filter-btn").forEach(btn =>
    btn.addEventListener("click", e => {
      document.querySelector("#categoryFilter .active").classList.remove("active");
      e.target.classList.add("active");
      currentCategoryFilter = e.target.dataset.category;
      expandedCategories = {};
      renderSites();
    })
  );

  document.getElementById("subjectFilter").addEventListener("change", e => {
    currentSubjectFilter = e.target.value;
    renderSites();
  });
}

// í•„í„° ì´ˆê¸°í™”
function resetFilters() {
  currentAgeFilter = "all";
  currentCategoryFilter = "all";
  currentSubjectFilter = "all";
  document.querySelector("#ageFilter .filter-btn[data-age='all']").click();
  document.querySelector("#categoryFilter .filter-btn[data-category='all']").click();
  document.getElementById("subjectFilter").value = "all";
  expandedCategories = {};
  renderSites();
}

// ëª¨ë‹¬ ê´€ë ¨
function openAddModal() {
  editingIndex = -1;
  document.getElementById("modalTitle").textContent = "ìƒˆ ì‚¬ì´íŠ¸ ì¶”ê°€";
  document.getElementById("siteForm").reset();
  document.getElementById("modal").style.display = "flex";
}

function openEditModal(index) {
  editingIndex = index;
  const site = sites[index];
  document.getElementById("modalTitle").textContent = "ì‚¬ì´íŠ¸ ìˆ˜ì •";
  
  // í¼ ì±„ìš°ê¸°
  document.getElementById("siteName").value = site.name;
  document.getElementById("siteUrl").value = site.url;




