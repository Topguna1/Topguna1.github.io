<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>딱 필요한 사이트 모음</title>
<style>
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:#333;transition:all 0.3s ease;}
body.dark{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);color:#fff;}
.container{max-width:1200px;margin:0 auto;background:rgba(255,255,255,0.95);border-radius:20px;backdrop-filter:blur(10px);box-shadow:0 20px 40px rgba(0,0,0,0.1);overflow:hidden;}
body.dark .container{background:rgba(26,26,46,0.95);box-shadow:0 20px 40px rgba(0,0,0,0.3);}
.header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:30px;text-align:center;position:relative;overflow:hidden;}
.header h1{margin:0 0 10px 0;font-size:2.5em;font-weight:700;}
.header p{margin:0;opacity:0.9;font-size:1.1em;}
.filters{padding:15px 30px;background:rgba(248,249,250,0.5);display:flex;gap:20px;flex-wrap:wrap;align-items:center;position:sticky;top:0;z-index:10;}
body.dark .filters{background:rgba(45,45,45,0.5);}
.filter-group{display:flex;flex-direction:column;gap:8px;min-width:120px;}
.filter-group label{font-weight:600;font-size:14px;color:#495057;}
body.dark .filter-group label{color:#adb5bd;}
.filter-buttons{display:flex;gap:6px;flex-wrap:wrap;padding:6px;}
.filter-btn{padding:8px 16px;border:2px solid #e9ecef;background:white;border-radius:20px;cursor:pointer;font-size:13px;font-weight:500;white-space:nowrap;transition:0.2s;}
.filter-btn:hover{border-color:#667eea;transform:translateY(-1px);}
.filter-btn.active{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border-color:#667eea;}
button{padding:10px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:14px;display:inline-flex;align-items:center;gap:8px;transition:0.2s;}
button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.15);}
.dark-toggle{background:linear-gradient(135deg,#343a40 0%,#212529 100%);color:white;margin-bottom:10px;position:sticky;top:10px;z-index:11;}
.categories-container{padding:20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:25px;}
.category-section{background:white;border-radius:15px;overflow:hidden;border:1px solid #e9ecef;transition:all 0.3s ease;box-shadow:0 5px 15px rgba(0,0,0,0.08);}
body.dark .category-section{background:#2d2d2d;border-color:#555;box-shadow:0 5px 15px rgba(0,0,0,0.3);}
.category-header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:20px 25px;font-size:18px;font-weight:700;display:flex;justify-content:space-between;align-items:center;gap:15px;}
.category-content{padding:25px;}
.link-card{border:2px solid #f1f3f5;border-radius:12px;padding:20px;margin:10px 0;background:linear-gradient(135deg,#ffffff 0%,#f8f9fa 100%);transition:all 0.5s ease, opacity 0.5s ease;opacity:0;transform:translateY(20px);}
.link-card.show{opacity:1;transform:translateY(0);}
body.dark .link-card{background:linear-gradient(135deg,#343a40 0%,#495057 100%);border-color:#555;}
.link-card a{text-decoration:none;color:#2c3e50;font-weight:700;font-size:18px;display:inline-block;margin-bottom:8px;}
body.dark .link-card a{color:#f8f9fa;}
.link-meta{display:flex;gap:8px;margin:12px 0;flex-wrap:wrap;}
.tag{padding:4px 10px;border-radius:15px;font-size:11px;font-weight:600;white-space:nowrap;}
.age-tag{background:linear-gradient(135deg,#d4edda 0%,#c3e6cb 100%);color:#155724;}
.category-tag{background:linear-gradient(135deg,#fff3cd 0%,#ffeaa7 100%);color:#856404;}
body.dark .age-tag{background:linear-gradient(135deg,#28a745 0%,#20c997 100%);color:white;}
body.dark .category-tag{background:linear-gradient(135deg,#ffc107 0%,#fd7e14 100%);color:#212529;}
.more-btn-container{text-align:center;margin-top:20px;}
.more-btn{background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);color:#495057;border:2px solid #dee2e6;padding:10px 20px;border-radius:25px;font-weight:600;transition:0.3s;}
.more-btn:hover{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border-color:#667eea;}
body.dark .more-btn{background:linear-gradient(135deg,#495057 0%,#343a40 100%);color:#f8f9fa;border-color:#555;}
</style>
</head>
<body>
<div class="container">
  <div class="header"><h1>🌟 딱필모</h1><p>딱 필요한 사이트만 모음</p></div>
  <div class="filters">
    <div class="filter-group">
      <label>🎯 연령대:</label>
      <div class="filter-buttons" id="ageFilter">
        <button class="filter-btn active" data-age="all">전체</button>
        <button class="filter-btn" data-age="elem">초등</button>
        <button class="filter-btn" data-age="mid">중등</button>
        <button class="filter-btn" data-age="high">고등</button>
        <button class="filter-btn" data-age="adult">성인</button>
      </div>
    </div>
    <div class="filter-group">
      <label>📂 카테고리:</label>
      <div class="filter-buttons" id="categoryFilter"></div>
    </div>
    <div class="filter-group">
      <label>📚 과목:</label>
      <select id="subjectFilter">
        <option value="all">전체 과목</option>
        <option value="korean">국어</option>
        <option value="math">수학</option>
        <option value="english">영어</option>
        <option value="science">과학</option>
        <option value="social">사회</option>
      </select>
    </div>
    <div class="filter-group">
      <button onclick="resetFilters()">🔄 필터 초기화</button>
    </div>
    <button class="dark-toggle" onclick="toggleDarkMode()">🌙 다크 모드</button>
  </div>
  <div class="categories-container" id="categoriesContainer"></div>
</div>

<script>
// ===== 데이터, 전역 변수 =====
const ageNames={elem:"초등학생",mid:"중학생",high:"고등학생",adult:"성인"};
const defaultCategories={learning:{name:"학습 사이트",icon:"📖"},info:{name:"정보 사이트",icon:"📋"}};
const customCategories={science_lab:{name:"과학 실험",icon:"🧪"}};
const initialSites=[
{name:"EBS",url:"https://www.ebs.co.kr",desc:"초등 전 과목 온라인 강의",category:"learning",ages:["elem"],subjects:["korean","math","science","social"]},
{name:"Khan Academy",url:"https://ko.khanacademy.org/",desc:"수학, 과학 무료 강의",category:"learning",ages:["elem","mid","high","adult"],subjects:["math","science"]},
{name:"Science Kids",url:"https://www.sciencekids.co.nz/",desc:"초등학생 과학 실험",category:"science_lab",ages:["elem"],subjects:["science"]}
];
let sites=[...initialSites];
let categoryCurrentDisplay={},currentAgeFilter="all",currentCategoryFilter="all",currentSubjectFilter="all";

// ===== 함수 정의 =====
function getAllCategories(){ return {...defaultCategories,...customCategories}; }
function getCategoryName(key){ const all=getAllCategories(); return all[key]?all[key].name:key; }
function getCategoryIcon(key){ const all=getAllCategories(); return all[key]?all[key].icon:"📁"; }

function createCategorySection(categoryKey){
  const cat=getAllCategories()[categoryKey]; if(!cat)return null;
  const section=document.createElement("div"); section.className="category-section"; section.id=`${categoryKey}-section`;
  section.innerHTML=`<div class="category-header"><div><span>${cat.icon}</span> ${cat.name}</div><div class="category-count" id="${categoryKey}-count">0</div></div><div class="category-content" id="${categoryKey}-content"></div>`;
  return section;
}

function createSiteCard(site){
  const ageTags=site.ages.map(a=>`<span class="tag age-tag">${ageNames[a]}</span>`).join(" ");
  const categoryTag=`<span class="tag category-tag">${getCategoryName(site.category)}</span>`;
  const card=document.createElement("div"); card.className="link-card";
  card.innerHTML=`<a href="${site.url}" target="_blank">${site.name}</a><div class="link-meta">${categoryTag} ${ageTags}</div><p>${site.desc}</p>`;
  return card;
}

function renderCategorySections(){
  const container=document.getElementById("categoriesContainer"); container.innerHTML="";
  Object.keys(getAllCategories()).forEach(cat=>{
    const sec=createCategorySection(cat); if(sec) container.appendChild(sec);
  });
}

function getFilteredSites(){
  return sites.filter(s=>(currentAgeFilter==="all"||s.ages.includes(currentAgeFilter))&&(currentCategoryFilter==="all"||s.category===currentCategoryFilter)&&(currentSubjectFilter==="all"||s.subjects.includes(currentSubjectFilter)));
}

function renderSites(){
  const allKeys=Object.keys(getAllCategories());
  const filtered=getFilteredSites();
  allKeys.forEach(cat=>{
    const container=document.getElementById(`${cat}-content`); 
    const section=document.getElementById(`${cat}-section`);
    const countEl=document.getElementById(`${cat}-count`);
    if(!container||!section) return;
    const sitesInCat=filtered.filter(s=>s.category===cat); container.innerHTML="";
    if(countEl) countEl.textContent=sitesInCat.length;
    if(sitesInCat.length>0){
      section.style.display="block";
      if(!categoryCurrentDisplay[cat] || categoryCurrentDisplay[cat]>sitesInCat.length) categoryCurrentDisplay[cat]=Math.min(3,sitesInCat.length);
      const sitesToShow=sitesInCat.slice(0,categoryCurrentDisplay[cat]);
      sitesToShow.forEach(s=>{
        const card=createSiteCard(s);
        container.appendChild(card);
        setTimeout(()=>{ card.classList.add("show"); },50);
      });
      if(categoryCurrentDisplay[cat]<sitesInCat.length){
        const btnContainer=document.createElement("div"); btnContainer.className="more-btn-container";
        const remain=sitesInCat.length-categoryCurrentDisplay[cat];
        const text=remain>5?"5개 더 보기 ↓":"모두 표시 완료 ✅";
        btnContainer.innerHTML=`<button class="more-btn" onclick="expandSites('${cat}')">${text}</button>`;
        container.appendChild(btnContainer);
      }
    } else section.style.display="none";
  });
}

function expandSites(cat){
  const allFiltered=getFilteredSites().filter(s=>s.category===cat);
  if(!categoryCurrentDisplay[cat]) categoryCurrentDisplay[cat]=0;
  categoryCurrentDisplay[cat]+=5;
  if(categoryCurrentDisplay[cat]>allFiltered.length) categoryCurrentDisplay[cat]=allFiltered.length;
  renderSites();
  if(categoryCurrentDisplay[cat]>3){
    Object.keys(getAllCategories()).forEach(c=>{
      const sec=document.getElementById(`${c}-section`);
      if(sec) sec.style.display=(c===cat)?"block":"none";
    });
  }
}

function setupFilters(){
  document.querySelectorAll("#ageFilter .filter-btn").forEach(btn=>btn.addEventListener("click",e=>{
    document.querySelector("#ageFilter .active")?.classList.remove("active");
    e.target.classList.add("active");
    currentAgeFilter=e.target.dataset.age; categoryCurrentDisplay={}; renderSites();
  }));
  const catFilter=document.getElementById("categoryFilter"); catFilter.innerHTML="";
  Object.entries(getAllCategories()).forEach(([key,val])=>{
    const btn=document.createElement("button"); btn.className="filter-btn"; btn.dataset.category=key; btn.textContent=val.name;
    btn.addEventListener("click",e=>{catFilter.querySelector(".active")?.classList.remove("active"); e.target.classList.add("active"); currentCategoryFilter=e.target.dataset.category; categoryCurrentDisplay={}; renderSites();});
    catFilter.appendChild(btn);
  });
  document.getElementById("subjectFilter").addEventListener("change",e=>{currentSubjectFilter=e.target.value; categoryCurrentDisplay={}; renderSites();});
}

function resetFilters(){ currentAgeFilter="all"; currentCategoryFilter="all"; currentSubjectFilter="all"; document.querySelector("#ageFilter .filter-btn[data-age='all']").click(); document.querySelector("#categoryFilter .filter-btn")?.click(); document.getElementById("subjectFilter").value="all"; categoryCurrentDisplay={}; renderSites();}
function toggleDarkMode(){document.body.classList.toggle("dark");}

document.addEventListener("DOMContentLoaded",()=>{renderCategorySections(); setupFilters(); renderSites();});
</script>
</body>
</html>
